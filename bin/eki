#!/bin/bash -e

[ "$1" = "pref" ] && shift && exec "$(dirname $0)/eki-pref" "$@"
[ "$1" = "adj" ] && shift && exec "$(dirname $0)/eki-adj" "$@"
[ "$1" = "line" ] && shift && exec "$(dirname $0)/eki-line" "$@"

[ "$1" = "-h" ] && {
	cat >&2 <<- EOF
	eki 0.2.1
	Copyright (C) 2021, Ryuichi Ueda.

	Usage: eki [option]

	These are some sub-commands (see eki [sub-command] -h):
	    pref [pref_code|pref_name]:  Show all prefectures with the lines in them.
	    line <station_name>:         Show lines avaliable at the station.
	    adj <station_name>:          Show adjoining stations.

	Released under MIT license
	https://github.com/ryuichiueda/eki
	EOF
	exit 0
}

DATA=/usr/share/eki/
[ -e "$DATA" ] || DATA="/eki/"
[ -e "$DATA" ] || DATA="$(dirname $0)/../eki/"

cat "$DATA/l/"*.xml   |
awk -F '[<>]' '/line_name/{line=$3}/station_name/{print line,$3}'
